celseq <- read.csv("/Users/stephenblough/Documents/snakemake/snake_data/CelSeq2_5cl/CelSeq2_5cl_data.csv", header = TRUE)
colnames(celseq)[1]
colnames(celseq)[2]
Liao <- readRDS("~/Documents/snakemake/snake_data/Liao.RDS")
colnames(Liao)[2]
View(Liao)
View(celseq)
View(celseq)
t(Liao)
x <- t(Liao)
library(Seurat)
tet <- CreateSeuratObject(x)
this_is_a_list_of_seurat_objects <- readRDS("~/Documents/snakemake/snake_data/this_is_a_list_of_seurat_objects.RDS")
Liaol <- this_is_a_list_of_seurat_objects$Liao
x <- as.data.frame(x)
x[1,2]
colnames(Liao)[2]
View(Liao)
View(Liaol)
View(Liao)
Liao <- x
rm(x, this_is_a_list_of_seurat_objects, Liao1)
rm(x, this_is_a_list_of_seurat_objects, Liaol)
wd()
we
wd
ls
ls()
rm(tet)
Lake <- readRDS("~/Documents/snakemake/snake_data/Lake.RDS")
Menon <- readRDS("~/Documents/snakemake/snake_data/Menon.RDS")
Wu <- readRDS("~/Documents/snakemake/snake_data/Wu.RDS")
Young <- readRDS("~/Documents/snakemake/snake_data/Young.RDS")
Wu <- as.data.frame(t(Wu))
View(Wu)
Lake <- as.data.frame(t(Lake))
Menon <- as.data.frame(t(Menon))
Young <- as.data.frame(t(Young))
rm(celseq)
library(data.table)
library(data.table)
fwrite(Wu, file = "snake_data/Wu.csv", row.names = TRUE)
write.csv(colnames(Wu), file = "snake_data/WuLabels.csv")
fwrite(Liao, file = "snake_data/Liao.csv", row.names = TRUE)
write.csv(colnames(Liao), file = "snake_data/LiaoLabels.csv")
fwrite(Lake, file = "snake_data/Lake.csv", row.names = TRUE)
write.csv(colnames(Lake), file = "snake_data/LakeLabels.csv")
fwrite(Menon, file = "snake_data/Menon.csv", row.names = TRUE)
write.csv(colnames(Menon), file = "snake_data/MenonLabels.csv")
fwrite(Young, file = "snake_data/Young.csv", row.names = TRUE)
write.csv(colnames(Young), file = "snake_data/YoungLabels.csv")
setwd("/Users/stephenblough/Documents/snakemake")
fwrite(Wu, file = "snake_data/Wu.csv", row.names = TRUE)
write.csv(colnames(Wu), file = "snake_data/WuLabels.csv")
fwrite(Liao, file = "snake_data/Liao.csv", row.names = TRUE)
write.csv(colnames(Liao), file = "snake_data/LiaoLabels.csv")
fwrite(Lake, file = "snake_data/Lake.csv", row.names = TRUE)
write.csv(colnames(Lake), file = "snake_data/LakeLabels.csv")
fwrite(Menon, file = "snake_data/Menon.csv", row.names = TRUE)
write.csv(colnames(Menon), file = "snake_data/MenonLabels.csv")
fwrite(Young, file = "snake_data/Young.csv", row.names = TRUE)
write.csv(colnames(Young), file = "snake_data/YoungLabels.csv")
f <- read.csv("snake_data/Wu.csv")
f <- read.csv("snake_data/Wu.csv", header = TRUE)
View(f)
tenx <- read.csv("/Users/stephenblough/Documents/snakemake/snake_data/10x_5cl/10x_5cl_data.csv", header = TRUE)
View(tenx)
rm(list = ls())
labs <- read.csv("snake_data/10x_5cl/10x_5cl_data.csv", header = TRUE)
file <- read.csv("snake_data/10x_5cl/Labels.csv")
View(file)
View(labs)
this_is_a_list_of_seurat_objects <- readRDS("~/Documents/snakemake/snake_data/this_is_a_list_of_seurat_objects.RDS")
Liao <- this_is_a_list_of_seurat_objects$Liao
Lake <- this_is_a_list_of_seurat_objects$Lake
Menon <- this_is_a_list_of_seurat_objects$Menon
Young <- this_is_a_list_of_seurat_objects$Young
Wu <- this_is_a_list_of_seurat_objects$Wu
rm(this_is_a_list_of_seurat_objects)
colnames(Liao) <- Liao@meta.data$Leveled_Names
colnames(Liao@assays$integrated@data) <- Liao@meta.data$Leveled_Names
colnames(Lake@assays$integrated@data) <- Lake@meta.data$Leveled_Names
colnames(Young@assays$integrated@data) <- Young@meta.data$Leveled_Names
colnames(Menon@assays$integrated@data) <- Menon@meta.data$Leveled_Names
colnames(Wu@assays$integrated@data) <- Wu@meta.data$Leveled_Names
Liao <- as.data.frame(as.matrix(Liao@assays$integrated@data))
View(Liao)
Lake <- as.data.frame(as.matrix(Lake@assays$integrated@data))
Menon <- as.data.frame(as.matrix(Menon@assays$integrated@data))
Wu <- as.data.frame(as.matrix(Wu@assays$integrated@data))
Young <- as.data.frame(as.matrix(Young@assays$integrated@data))
View(file)
View(labs)
Wu <- as.data.frame(t(Wu))
Liao <- as.data.frame(t(Liao))
Lake <- as.data.frame(t(Lake))
Menon <- as.data.frame(t(Menon))
Young <- as.data.frame(t(Young))
x <- rownames(Wu)
write.csv(rownames(Wu), file = "snake_data/WuLabels.csv")
write.csv(rownames(Liao), file = "snake_data/LiaoLabels.csv")
write.csv(rownames(Lake), file = "snake_data/LakeLabels.csv")
write.csv(rownames(Menon), file = "snake_data/MenonLabels.csv")
write.csv(rownames(Young), file = "snake_data/YoungLabels.csv")
rm(list = ls())
test <- read.csv("snake_data/Wu.csv")
test <- read.csv("snake_data/Wu.csv", header = TRUE)
labeltest <- read.csv("snake_data/WuLabels.csv")
View(labeltest)
Wu <- readRDS("~/Documents/snakemake/snake_data/Wu.RDS")
Liao <- readRDS("~/Documents/snakemake/snake_data/Liao.RDS")
Menon <- readRDS("~/Documents/snakemake/snake_data/Menon.RDS")
Lake <- readRDS("~/Documents/snakemake/snake_data/Lake.RDS")
Young <- readRDS("~/Documents/snakemake/snake_data/Young.RDS")
Wu <- as.data.frame(t(Wu))
Liao <- as.data.frame(t(Liao))
Lake <- as.data.frame(t(Lake))
Menon <- as.data.frame(t(Menon))
Young <- as.data.frame(t(Young))
wulab <- rownames(Wu)
write.csv(wulab, file = "snake_data/WuLabels.csv")
labeltest <- read.csv("snake_data/WuLabels.csv")
rm(Lake,Liao,Menon,Wu,Young)
Lake <- readRDS("~/Documents/snakemake/snake_data/Lake.RDS")
Liao <- readRDS("~/Documents/snakemake/snake_data/Liao.RDS")
Menon <- readRDS("~/Documents/snakemake/snake_data/Menon.RDS")
Wu <- readRDS("~/Documents/snakemake/snake_data/Wu.RDS")
Young <- readRDS("~/Documents/snakemake/snake_data/Young.RDS")
write.csv(colnames(Wu), file = "snake_data/WuLabels.csv")
labeltest <- read.csv("snake_data/WuLabels.csv")
colnames(wu)
colnames(Wu)
x <- colnames(Wu)
write.csv(x, "snake_data/WuLabels.csv")
labeltest <- read.csv("snake_data/WuLabels.csv")
View(labeltest)
write.csv(x, "snake_data/WuLabels.csv", row.names = FALSE)
labeltest <- read.csv("snake_data/WuLabels.csv")
x <- colnames(Wu)
Wu <- as.data.frame(t(Wu))
Liao <- as.data.frame(t(Liao))
Lake <- as.data.frame(t(Lake))
Menon <- as.data.frame(t(Menon))
Young <- as.data.frame(t(Young))
write.csv(rownames(Wu), file = "snake_data/WuLabels.csv", row.names = FALSE)
write.csv(rownames(Liao), file = "snake_data/LiaoLabels.csv", row.names = FALSE)
write.csv(rownames(Lake), file = "snake_data/LakeLabels.csv", row.names = FALSE)
write.csv(rownames(Menon), file = "snake_data/MenonLabels.csv", row.names = FALSE)
write.csv(rownames(Young), file = "snake_data/YoungLabels.csv", row.names = FALSE)
labeltest <- read.csv("snake_data/WuLabels.csv")
labeltest <- read.csv("snake_data/LakeLabels.csv")
labeltest <- read.csv("snake_data/LiaoLabels.csv")
labeltest <- read.csv("snake_data/MenonLabels.csv")
labeltest <- read.csv("snake_data/YoungLabels.csv")
Azimuth::AzimuthApp(reference = "/Users/stephenblough/Documents/Azimuth/Reference")
sobj <- readRDS("~/Documents/snakemake/snake_data/sobj2_9.RDS")
NoLake <- subset(sobj, subset = Study != "Lake")
NoLiao <- subset(sobj, subset = Study != "Liao")
NoMenon <- subset(sobj, subset = Study != "Menon")
NoYoung <- subset(sobj, subset = Study != "Young")
NoWu <- subset(sobj, subset = Study != "Wu")
rm(sobj)
rm(NoYoung)
rm(NoMenon)
lakerow <- NoLake@meta.data$Annotated_Clustering
liaorow <- NoLiao@meta.data$Annotated_Clustering
lakeincase <- NoLake$Leveled_Names
liaoincase <- NoLiao$Leveled_Names
NoLake <- as.data.frame(as.matrix(NoLake@assays$integrated@data))
NoLiao <- as.data.frame(as.matrix(NoLiao@assays$integrated@data))
NoLiao <- as.data.frame(t(NoLiao))
NoLake <- as.data.frame(t(NoLake))
fwrite(NoLiao, file = "snake_data/NoLiao.csv", row.names = TRUE)
fwrite(NoLake, file = "snake_data/NoLake.csv", row.names = TRUE)
library(data.table)
fwrite(NoLiao, file = "snake_data/NoLiao.csv", row.names = TRUE)
fwrite(NoLake, file = "snake_data/NoLake.csv", row.names = TRUE)
write.csv(liaorow, file = "snake_data/NoLiaoLabels.csv", row.names = FALSE)
write.csv(lakerow, file = "snake_data/NoLakeLabels.csv", row.names = FALSE)
write.csv(liaoincase, file = "snake_data/NoLiaoLabelsLevel.csv", row.names = FALSE)
write.csv(lakeincase, file = "snake_data/NoLakeLabelsLevel.csv", row.names = FALSE)
rm(list = ls())
sobj <- readRDS("~/Documents/snakemake/snake_data/sobj2_9.RDS")
NoMenon <- subset(sobj, subset = Study != "Menon")
menonrow <- NoMenon@meta.data$Annotated_Clustering
menonincase <- NoMenon$Leveled_Names
NoYoung <- subset(sobj, subset = Study != "Young")
youngrow <- NoYoung@meta.data$Annotated_Clustering
youngincase <- NoYoung$Leveled_Names
NoWu <- subset(sobj, subset = Study != "Wu")
wurow <- NoWu@meta.data$Annotated_Clustering
wuincase <- NoWu$Leveled_Names
rm(sobj)
NoMenon <- as.data.frame(as.matrix(NoMenon@assays$integrated@data))
NoYoung <- as.data.frame(as.matrix(NoYoung@assays$integrated@data))
NoWu <- as.data.frame(as.matrix(NoWu@assays$integrated@data))
NoWu <- as.data.frame(t(NoWu))
NoMenon <- as.data.frame(t(NoMenon))
NoYoung <- as.data.frame(t(NoYoung))
fwrite(NoWu, file = "snake_data/NoWu.csv", row.names = TRUE)
fwrite(NoLake, file = "snake_data/NoLake.csv", row.names = TRUE)
fwrite(NoMenon, file = "snake_data/NoMenon.csv", row.names = TRUE)
fwrite(NoYoung, file = "snake_data/NoYoung.csv", row.names = TRUE)
write.csv(wurow, file = "snake_data/NoWuLabels.csv", row.names = FALSE)
write.csv(lakerow, file = "snake_data/NoLakeLabels.csv", row.names = FALSE)
write.csv(menonrow, file = "snake_data/NoMenonLabels.csv", row.names = FALSE)
write.csv(youngrow, file = "snake_data/NoYoungLabels.csv", row.names = FALSE)
write.csv(wuincase, file = "snake_data/NoWuLabelsLevel.csv", row.names = FALSE)
write.csv(menonincase, file = "snake_data/NoMenonLabelsLevel.csv", row.names = FALSE)
write.csv(youngincase, file = "snake_data/NoYoungLabelsLevel.csv", row.names = FALSE)
rm(list = ls())
sobj <- readRDS("~/Documents/snakemake/snake_data/this_is_a_list_of_seurat_objects.RDS")
Wu <- sobj$Wu
Liao <- sobj$Liao
Lake <- sobj$Lake
Young <- sobj$Young
Menon <- sobj$Menon
lakerow <- Lake@meta.data$Annotated_Clustering
liaorow <- Liao@meta.data$Annotated_Clustering
menonrow <- Menon@meta.data$Annotated_Clustering
youngrow <- Young@meta.data$Annotated_Clustering
wurow <- Wu@meta.data$Annotated_Clustering
write.csv(wurow, file = "snake_data/WuLabels.csv", row.names = FALSE)
write.csv(liaorow, file = "snake_data/LiaoLabels.csv", row.names = FALSE)
write.csv(lakerow, file = "snake_data/LakeLabels.csv", row.names = FALSE)
write.csv(menonrow, file = "snake_data/MenonLabels.csv", row.names = FALSE)
write.csv(youngrow, file = "snake_data/YoungLabels.csv", row.names = FALSE)
test <- read.csv("snake_data/Wu/Wu.csv", header = TRUE)
test <- log(test+1, base = 2)
View(test)
test <- log(test+1, base = 2)
test <- log(test, base = 2)
View(test)
test <- subset(test, select = -1)
test <- log(test+1, base = 2)
log(0)
log(1)
log(-0.99 + 1)
file <- list.files("snakemake/snake_data/Our_Data/")
file <- list.files("snakemake/snake_data/Our_Data/", pattern = "No")
file
file <- list.files("snake_data/Our_Data/")
files <- file
med_F1 <- matrix(1:length(files), nrow = length(files), ncol = length(files) + 1, dimnames = list(c(files[1], files[2], files[3], files[4], files[5])))
View(med_F1)
data <- read.csv(file = file.path(files[1],"evalution", "Summary", "SVM_crossdata.csv"))
test <- read.csv("snake_data/Wu/Wu.csv", header = TRUE)
test <- subset(test, select = -1)
View(med_F1)
View(med_F1)
View(test)
test <- read.csv("snake_data/Wu/Wu.csv", header = TRUE)
View(test)
write.csv(med_F1, "snakemake_crossdata.csv")
this_is_a_list_of_seurat_objects <- readRDS("~/Documents/snakemake/snake_data/this_is_a_list_of_seurat_objects.RDS")
men <- this_is_a_list_of_seurat_objects$Menon
sobj2_9 <- readRDS("~/Documents/snakemake/snake_data/sobj2_9.RDS")
rm(this_is_a_list_of_seurat_objects)
NoLake <- subset(sobj, subset = Study != "Lake")
NoLake <- subset(sobj2_9, subset = Study != "Lake")
data <- read.csv(file = file.path("snake_data", "10x_train","evalution", "Summary", "SVM_crossdata.csv"))
data <- read.csv(file = file.path("snake_data", "10x_train","evaluation", "Summary", "SVM_crossdata.csv"))
data <- read.csv(file = file.path("snake_data", "10x_train", "Summary", "SVM_crossdata.csv"))
data <- read.csv(file = file.path("snake_data", "10x_train", "Summary", "SVM_crossdata_1.csv"))
files <- "10x_train"
data <- read.csv(file = file.path("snake_data", file, "Summary", "SVM_crossdata_1.csv"))
data <- read.csv(file = file.path("snake_data", files, "Summary", "SVM_crossdata_1.csv"))
med_F1 <- matrix(,nrow = length(files), ncol = 2)
med_F1 <- matrix(,nrow=5, ncol=2)
med_f1[1,1] <- "s"
med_F1[1,1] <- "s"
med_F1[2,1] <- "s"
med_F1[3,1] <- "s"
med_F1[4,1] <- "s"
med_F1[5,1] <- "s"
med_F1[1,2] <- 12
med_F1[2,2] <- 12
med_F1[3,2] <- 12
med_F1[4,2] <- 12
med_F1[5,2] <- 12
rownames(med_F1) <- med_F1[,1]
View(med_F1)
med_F1 <- subset(med_F1, select = -1)
as.numeric(med_F1)
med_F1 <- as.numeric(med_F1)
rownames(med_F1) <- med_F1[,1]
med_F1[,1]
med_F1 <- as.matrix(med_F1)
rownames(med_F1) <- med_F1[,1]
med_F1 <- matrix(,nrow = length(files), ncol = 2)
med_F1 <- matrix(,nrow=5, ncol=2)
med_F1[1,1] <- "s"
med_F1[2,1] <- "s"
med_F1[3,1] <- "s"
med_F1[4,1] <- "s"
med_F1[5,1] <- "s"
med_F1[1,2] <- 12
med_F1[2,2] <- 12
med_F1[3,2] <- 12
med_F1[4,2] <- 12
med_F1[5,2] <- 12
rownamesf1 <- med_F1[,1]
med_F1 <- subset(med_F1, select = -1)
med_F1 <- as.matrix(as.numeric(med_F1))
View(med_F1)
rownames(med_F1) <- rownamesf1
View(med_F1)
pheatmap(med_F1, display_numbers = TRUE, color = rev(viridis(256)), angle_col = 45)
library(pheatmap)
library(tidyverse)
library(writexl)
library(viridis)
pheatmap(med_F1, display_numbers = TRUE, color = rev(viridis(256)), angle_col = 45)
View(med_F1)
med_F1 <- matrix(,nrow=5, ncol=6)
med_F1[1,1] <- "s"
med_F1[2,2] <- "s"
med_F1[3,3] <- "s"
med_F1[4,4] <- "s"
med_F1[1,1] <- "s"
med_F1 <- matrix(,nrow=5, ncol=6)
med_F1[1,1] <- "s"
med_F1[2,1] <- "s"
med_F1[3,1] <- "s"
med_F1[4,1] <- "s"
med_F1[5,1] <- "s"
med_F1[1,2] <- 12
med_F1[2,3] <- 12
med_F1[3,4] <- 12
med_F1[4,5] <- 12
med_F1[5,6] <- 12
rownamesf1 <- med_F1[,1]
med_F1 <- subset(med_F1, select = -1)
med_F1 <- as.matrix(as.numeric(med_F1))
rownames(med_F1) <- rownamesf1
View(med_F1)
med_F1 <- as.matrix(as.numeric(med_F1))
med_F1 <- as.data.frame(as.numeric(med_F1))
Lake <- read.csv("snake_data/Lake/Lake.csv")
NoLake <- read.csv("snake_data/Our_Data/NoLake/NoLake.csv")
Lake <- read.csv("snake_data/Lake/Lake.csv", header = TRUE)
Lake <- read.csv("snake_data/Lake/Lake.csv", header = TRUE)
NoLake <- read.csv("snake_data/Our_Data/NoLake/NoLake.csv", header = TRUE)
View(Lake)
View(NoLake)
Menon <- read.csv("snake_data/Menon/Menon.csv", header = TRUE)
NoMenon <- read.csv("snake_data/Our_Data/NoMenon/NoMenon.csv", header = TRUE)
rm(list = ls())
TrueLabelsPath <- "snake_data/Menon/SVM_crossdata_true.csv"
PredLabelsPath <- "snake_data/Menon/SVM_crossdata_pred.csv"
true_lab <- unlist(read.csv(TrueLabelsPath))
pred_lab <- unlist(read.csv(PredLabelsPath))
if (! is.null(Indices)){
true_lab <- true_lab[Indices]
pred_lab <- pred_lab[Indices]
}
unique_true <- unlist(unique(true_lab))
unique_pred <- unlist(unique(pred_lab))
unique_all <- unique(c(unique_true,unique_pred))
conf <- table(true_lab,pred_lab)
pop_size <- rowSums(conf)
pred_lab = gsub('Node..','Node',pred_lab)
conf_F1 <- table(true_lab,pred_lab,exclude = c('unassigned','Unassigned','Unknown','rand','Node','ambiguous','unknown'))
F1 <- vector()
sum_acc <- 0
for (i in c(1:length(unique_true))){
findLabel = colnames(conf_F1) == row.names(conf_F1)[i]
if(sum(findLabel)){
prec <- conf_F1[i,findLabel] / colSums(conf_F1)[findLabel]
rec <- conf_F1[i,findLabel] / rowSums(conf_F1)[i]
if (prec == 0 || rec == 0){
F1[i] = 0
} else{
F1[i] <- (2*prec*rec) / (prec + rec)
}
sum_acc <- sum_acc + conf_F1[i,findLabel]
} else {
F1[i] = 0
}
}
pop_size <- pop_size[pop_size > 0]
names(F1) <- names(pop_size)
med_F1 <- median(F1)
total <- length(pred_lab)
num_unlab <- sum(pred_lab == 'unassigned') + sum(pred_lab == 'Unassigned') + sum(pred_lab == 'rand') + sum(pred_lab == 'Unknown') + sum(pred_lab == 'unknown') + sum(pred_lab == 'Node') + sum(pred_lab == 'ambiguous')
per_unlab <- num_unlab / total
acc <- sum_acc/sum(conf_F1)
result <- list(Conf = conf, MedF1 = med_F1, F1 = F1, Acc = acc, PercUnl = per_unlab, PopSize = pop_size)
result$MedF1
View(result$Conf)
as.data.frame(as.matrix(table(result$Conf)))
data <- readRDS("~/Documents/snakemake/snake_data/this_is_a_list_of_seurat_objects.RDS")
menon <- data$Menon
Menon <- as.data.frame(as.matrix(menon@assays$integrated@data))
min(Menon)
sobj <- readRDS("~/Documents/snakemake/snake_data/sobj2_9.RDS")
rm(data,menon,Menon)
NoMenon <- subset(sobj, subset = Study != "Menon")
NoMenon <- as.data.frame(as.matrix(NoMenon@assays$integrated@data))
min(NoMenon)
shiny::runApp('~/Documents/Azimuth/azimuth-master/R')
runApp('~/Documents/Azimuth/azimuth-master/R')
runApp('~/Documents/Azimuth/azimuth-master/R')
